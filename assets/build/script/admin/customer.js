let pValidator,customerState={modalType:"create",modalName:"customerModalForm",loading:!1};function customerSetLoading(e){customerState.loading=e;let t=document.querySelectorAll(".jsCustomerAction"),o=document.getElementById("customerFormSubmit");customerState.loading?(o&&(o.setAttribute("disabled","disabled"),o.classList.add("loading")),t&&t.forEach(e=>{e.setAttribute("disabled","disabled")})):(o&&(o.removeAttribute("disabled"),o.classList.remove("loading")),t&&t.forEach(e=>{e.removeAttribute("disabled")}))}function customerList(e=1,t=10,o=""){let m=document.getElementById("customerTable");m&&(SnFreeze.freeze({selector:"#customerTable"}),RequestApi.fetch(`/admin/customer/table?limit=${t}&page=${e}&search=${o}`,{method:"GET"}).then(e=>{e.success?m.innerHTML=e.view:SnModal.error({title:"Algo salió mal",content:e.message})}).finally(e=>{SnFreeze.unFreeze("#customerTable")}))}function customerClearForm(){let e=document.getElementById("customerForm"),t=document.getElementById("customerEmail");e&&e.reset(),t&&setTimeout(()=>{t.focus()},500),pValidator.reset()}function customerSubmit(e){if(e.preventDefault(),!pValidator.validate())return;customerSetLoading(!0);let t={};t.identityDocumentId=document.getElementById("customerIdentityDocumentId").value,t.documentNumber=document.getElementById("customerDocumentNumber").value,t.socialReason=document.getElementById("customerSocialReason").value,t.commercialReason=document.getElementById("customerCommercialReason").value,t.fiscalAddress=document.getElementById("customerFiscalAddress").value,t.email=document.getElementById("customerEmail").value,t.telephone=document.getElementById("customerTelephone").value,"update"===customerState.modalType&&(t.customerId=document.getElementById("customerId").value||0),RequestApi.fetch("/admin/customer/"+customerState.modalType,{method:"POST",body:t}).then(e=>{e.success?(SnModal.close(customerState.modalName),SnMessage.success({content:e.message}),customerList()):SnModal.error({title:"Algo salió mal",content:e.message})}).finally(e=>{customerSetLoading(!1)})}function customerDelete(e,t=""){SnModal.confirm({title:"¿Estás seguro de eliminar este registro?",content:t,okText:"Si",okType:"error",cancelText:"No",onOk(){customerSetLoading(!0),RequestApi.fetch("/admin/customer/delete",{method:"POST",body:{customerId:e||0}}).then(e=>{e.success?(SnMessage.success({content:e.message}),customerList()):SnModal.error({title:"Algo salió mal",content:e.message})}).finally(e=>{customerSetLoading(!1)})}})}function customerShowModalCreate(){customerState.modalType="create",customerClearForm(),SnModal.open(customerState.modalName)}function customerShowModalUpdate(e){customerState.modalType="update",customerGetById(e)}function customerGetById(e){customerClearForm(),customerSetLoading(!0),RequestApi.fetch("/admin/customer/id",{method:"POST",body:{customerId:e||0}}).then(e=>{e.success?(document.getElementById("customerIdentityDocumentId").value=e.result.identity_document_id,document.getElementById("customerDocumentNumber").value=e.result.document_number,document.getElementById("customerSocialReason").value=e.result.social_reason,document.getElementById("customerCommercialReason").value=e.result.commercial_reason,document.getElementById("customerFiscalAddress").value=e.result.fiscal_address,document.getElementById("customerEmail").value=e.result.email,document.getElementById("customerTelephone").value=e.result.telephone,document.getElementById("customerId").value=e.result.customer_id,SnModal.open(customerState.modalName)):SnModal.error({title:"Algo salió mal",content:e.message})}).finally(e=>{customerSetLoading(!1)})}function customerToExcel(){let e=document.getElementById("customerCurrentTable");e&&TableToExcel(e.outerHTML,"Usuario","Usuario")}function customerToPrint(){printArea("customerCurrentTable")}document.addEventListener("DOMContentLoaded",()=>{pValidator=new Pristine(document.getElementById("customerForm")),document.getElementById("searchContent").addEventListener("input",e=>{customerList(1,10,e.target.value)}),customerList()});